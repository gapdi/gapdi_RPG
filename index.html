<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VILLAIN HUNTER : HARD MODE</title>
    <style>
        :root {
            --bg-color: #0c0c0c; --panel-bg: #1a1a1a; --text-main: #eeeeee;
            --common: #ffffff; --rare: #ffff00; --epic: #bf00ff;
            --unique: #00f2ff; --danger: #ff4444; --border: #333333; --gold: #ffd700;
        }
        body { background: var(--bg-color); color: var(--text-main); font-family: 'Pretendard', sans-serif; display: flex; justify-content: center; padding: 20px; margin: 0; line-height: 1.4; font-size: 14px; }
        #game-container { width: 100%; max-width: 480px; background: var(--panel-bg); border-radius: 20px; padding: 25px; border: 1px solid var(--border); position: relative; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        
        /* ë„ê° ìƒì‹œ í‘œì‹œë°” */
        .book-status-bar { background: rgba(0,0,0,0.5); border-radius: 12px; padding: 12px; margin-bottom: 15px; border: 1px solid var(--gold); }
        .book-progress-bg { width: 100%; height: 8px; background: #222; border-radius: 4px; overflow: hidden; margin: 5px 0; }
        #book-progress-fill { width: 0%; height: 100%; background: linear-gradient(90deg, #ff0080, var(--gold)); transition: width 0.5s; }

        /* [NEW] ìƒì„¸ ìŠ¤í…Œì´í„°ìŠ¤ íŒ¨ë„ */
        .status-panel { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; background: #000; padding: 12px; border-radius: 10px; margin-bottom: 15px; border: 1px solid #333; }
        .stat-item { display: flex; justify-content: space-between; font-size: 12px; }
        .stat-label { color: #888; }
        .stat-val { color: var(--gold); font-weight: bold; }

        .equip-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 6px; margin-bottom: 15px; }
        .equip-slot { background: #111; border: 1px solid #444; padding: 6px; border-radius: 8px; text-align: center; font-size: 10px; height: 60px; display: flex; flex-direction: column; justify-content: center; }
        .equip-slot span { color: #666; display: block; font-size: 9px; }
        .equip-name { color: #fff; font-weight: bold; font-size: 10px; margin-top: 2px; }

        .panel { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 15px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.1); }
        .hp-bar-bg { width: 100%; height: 14px; background: #222; margin: 8px 0; border-radius: 7px; overflow: hidden; border: 1px solid #333; position: relative; }
        .hp-fill { height: 100%; transition: width 0.3s; }
        .hp-text { position: absolute; width: 100%; text-align: center; font-size: 9px; font-weight: bold; line-height: 14px; color: #fff; text-shadow: 1px 1px 2px #000; }
        
        button { background: #ffffff; color: #000000; border: none; padding: 12px; cursor: pointer; font-weight: 900; border-radius: 8px; width: 100%; font-size: 14px; }
        .btn-heal { background: #e74c3c; color: #fff; }
        .btn-heal:disabled { background: #444; color: #888; cursor: not-allowed; }

        #log-window { height: 100px; overflow-y: auto; font-size: 11px; color: #bbb; padding: 10px; background: #000; border-radius: 10px; border: 1px solid #333; margin-top: 10px; }
        .log-entry { margin-bottom: 3px; border-bottom: 1px solid #111; }
        
        .modal { display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 100; background: rgba(0,0,0,0.95); flex-direction: column; align-items: center; justify-content: center; border-radius: 20px; padding: 20px; box-sizing: border-box; }
        .book-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; width: 100%; max-height: 300px; overflow-y: auto; }
        .book-item { padding: 5px; background: #222; border-radius: 4px; font-size: 10px; border: 1px solid #333; color: #444; }
        .book-item.unlocked { color: #fff; border-color: var(--unique); }
        
        .skill-name { color: var(--danger); font-weight: bold; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="game-over" class="modal">
        <h1 style="color:var(--danger);">MENTAL BREAK</h1>
        <div id="killer-name" style="color: #fff;"></div>
        <div id="death-quote" style="font-style: italic; color: #888; margin: 15px 0;"></div>
        <button onclick="location.reload()">ìƒˆ ì´ë ¥ì„œ ë˜ì§€ê¸°</button>
    </div>

    <div id="book-modal" class="modal">
        <h2 style="color:var(--gold);">ë¹ŒëŸ° ë„ê°</h2>
        <div class="book-grid" id="book-grid"></div>
        <button onclick="toggleBook()" style="margin-top: 15px;">ë‹«ê¸°</button>
    </div>

    <div class="book-status-bar">
        <div style="display:flex; justify-content:space-between; align-items: flex-end;">
            <div>
                <span style="color:var(--unique); font-size:11px;" id="current-stage-text">STAGE 1</span><br>
                <span style="font-size:18px; font-weight:900; color:var(--gold);">COLLECT <span id="book-main-count">0</span>/50</span>
            </div>
            <div id="player-title" style="font-size:11px; color:var(--unique);">ì‹ ì… ì‚¬ì›</div>
        </div>
        <div class="book-progress-bg"><div id="book-progress-fill"></div></div>
    </div>

    <div class="status-panel">
        <div class="stat-item"><span class="stat-label">Lv.</span><span class="stat-val" id="st-lv">1</span></div>
        <div class="stat-item"><span class="stat-label">ì²˜ì¹˜ìˆ˜</span><span class="stat-val" id="st-kills">0</span></div>
        <div class="stat-item"><span class="stat-label">ê³µê²©ë ¥</span><span class="stat-val" id="st-atk">10</span></div>
        <div class="stat-item"><span class="stat-label">ì¹˜ëª…íƒ€</span><span class="stat-val" id="st-crit">5%</span></div>
        <div class="stat-item"><span class="stat-label">íšŒí”¼ìœ¨</span><span class="stat-val" id="st-dodge">5%</span></div>
        <div class="stat-item"><span class="stat-label">ì†Œì§€ê¸ˆ</span><span class="stat-val" id="st-gold">0</span></div>
    </div>

    <div class="equip-grid">
        <div class="equip-slot"><span>ë¬´ê¸°</span><div class="equip-name" id="eq-weapon">-</div></div>
        <div class="equip-slot"><span>ëª¨ì</span><div class="equip-name" id="eq-hat">-</div></div>
        <div class="equip-slot"><span>ìƒì˜</span><div class="equip-name" id="eq-top">-</div></div>
        <div class="equip-slot"><span>í•˜ì˜</span><div class="equip-name" id="eq-bottom">-</div></div>
        <div class="equip-slot"><span>ì¥ê°‘</span><div class="equip-name" id="eq-glove">-</div></div>
        <div class="equip-slot"><span>ëª©ê±¸ì´</span><div class="equip-name" id="eq-neck">-</div></div>
        <div class="equip-slot"><span>ì†ëª©</span><div class="equip-name" id="eq-wrist">-</div></div>
        <div class="equip-slot" style="border-color:var(--gold);"><span style="color:var(--gold)">í¬ì…˜</span><div class="equip-name" id="heal-count">0</div></div>
    </div>

    <div class="panel">
        <div class="hp-bar-bg">
            <div id="p-hp-bar" class="hp-fill" style="background:#fff; width:100%;"></div>
            <div class="hp-text" id="p-hp-text">100 / 100</div>
        </div>
        <button id="heal-btn" class="btn-heal" onclick="usePotion()">ğŸ• í”¼ì ë¨¹ê¸° (íšŒë³µ)</button>
    </div>

    <div class="panel" style="border-left: 4px solid var(--danger);">
        <div style="display:flex; justify-content:space-between; align-items: center; margin-bottom:5px;">
            <div id="m-name" style="font-weight:900;">ë¹ŒëŸ° ì°¾ëŠ” ì¤‘...</div>
            <div id="m-hp-val" style="font-size: 11px; color: #888;">0 / 0</div>
        </div>
        <div class="hp-bar-bg"><div id="m-hp-bar" class="hp-fill" style="background:var(--danger); width:100%;"></div></div>
    </div>

    <div id="log-window"></div>
    <button onclick="toggleBook()" style="margin-top:10px; font-size:11px; background:none; color:#666; border:1px solid #333; padding:5px;">ìƒì„¸ ë„ê° ì—´ê¸°</button>
</div>

<script>
    // ëª¬ìŠ¤í„° ë°ì´í„° (ì´ì „ê³¼ ë™ì¼í•œ 5ê·¸ë£¹ 50ì¢… ë¡œì§)
    const MONSTER_GROUPS = [
        [
            { name: "ì¶œê·¼ ëŒ€ë¦¬ë‹˜", hp: 60, atk: 6, skill: "ì„œë¥˜ ë˜ì§€ê¸°", killMsg: "ê±° ê¹€ëŒ€ë¦¬, ì´ ì„œë¥˜ ì˜¤ëŠ˜ê¹Œì§€ì•¼." },
            { name: "ìŠ¤íŒ¸ ì „í™” 070", hp: 45, atk: 5, skill: "ê¿€ì  ë°©í•´", killMsg: "ë‚®ì  ìëŠ”ë° ëŒ€ì¶œ ê¶Œìœ ë¼ë‹ˆ." },
            { name: "ë°ì´í„° ì—†ëŠ” í°", hp: 50, atk: 8, skill: "ì˜¤í”„ë¼ì¸ ê³ ë¦½", killMsg: "ë¡œë”© ìŠ¤í”¼ë„ˆë§Œ 10ë¶„ì§¸." },
            { name: "USB ë°˜ëŒ€ë¡œ ë¼ì›€", hp: 50, atk: 5, skill: "ë‹¨ì ì…êµ¬ë§‰ê¸°", killMsg: "ë’¤ì§‘ì–´ë„ ì•ˆ ë“¤ì–´ê°€ìš”." },
            { name: "ì•ˆ ì”»ì€ í…€ë¸”ëŸ¬", hp: 60, atk: 10, skill: "ê³°íŒ¡ì´ í–¥ê¸°", killMsg: "ì»¤í”¼ì—ì„œ ëœì¥ ë§›ì´ ë‚©ë‹ˆë‹¤." },
            { name: "ëˆ…ëˆ…í•œ ì‹œë¦¬ì–¼", hp: 45, atk: 5, skill: "ì¢…ì´ ì‹ê°", killMsg: "ì¢…ì´ ì”¹ëŠ” ì¤„ ì•Œì•˜ìŠµë‹ˆë‹¤." },
            { name: "ì•ˆí„°ì§€ëŠ” WIFI", hp: 70, atk: 12, skill: "ë¬´í•œ ë¡œë”©", killMsg: "ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ëŒ€ìš”." },
            { name: "ì¹¨ëŒ€ ë°‘ ë¦¬ëª¨ì»¨", hp: 75, atk: 10, skill: "êµ¬ì„ ìˆ¨ê¸°ê¸°", killMsg: "ê²°êµ­ ì¼ì–´ë‚˜ì„œ ê»ìŠµë‹ˆë‹¤." },
            { name: "ë¹¨ê°„ë¶ˆ íš¡ë‹¨ë³´ë„", hp: 80, atk: 12, skill: "ë²„ìŠ¤ ë†“ì¹˜ê¸°", killMsg: "ë²„ìŠ¤ê°€ ë°©ê¸ˆ ë– ë‚¬ìŠµë‹ˆë‹¤." },
            { name: "ê´‘ê³  ìŠ¤í‚µ ë¶ˆê°€", hp: 85, atk: 13, skill: "ê°•ì œ 15ì´ˆ", killMsg: "15ì´ˆê°€ 15ë…„ ê°™ì•˜ìŠµë‹ˆë‹¤." }
        ],
        // ... (ê·¸ë£¹ 2~5 ìƒëµ, ì‹¤ì œ ì½”ë“œì—ëŠ” í¬í•¨ë¨)
    ];

    // [ê·¸ë£¹ 2~5 ë°ì´í„° ë³µêµ¬/ìœ ì§€]
    MONSTER_GROUPS[1] = [
        { name: "ë²•ì¹´ ë¶€ì¥ë‹˜", hp: 120, atk: 18, skill: "ê°‘ì‘ìŠ¤ëŸ° íšŒì‹", killMsg: "ì˜¤ëŠ˜ íšŒì‹ì€ ì‚¼ê²¹ì‚´ì´ë‹¤!" },
        { name: "ë¼ë–¼ ì°¨ì¥ë‹˜", hp: 140, atk: 20, skill: "ë‚˜ ë•ŒëŠ” ë§ì´ì•¼", killMsg: "ë‚˜ ë•ŒëŠ” ë§ì´ì•¼..." },
        { name: "ì´ì–´í° í•œìª½ ê³ ì¥", hp: 130, atk: 15, skill: "ëª¨ë…¸ ì‚¬ìš´ë“œ", killMsg: "ì™¼ìª½ ê·€ê°€ ì™¸ë¡­ìŠµë‹ˆë‹¤." },
        { name: "ì¹´ê³µì¡±ì˜ ëˆˆì´", hp: 110, atk: 15, skill: "í•œìˆ¨ ì‰¬ê¸°", killMsg: "í‚¤ë³´ë“œ ì†Œë¦¬ê°€ ì£„ì¸ê°€ìš”?" },
        { name: "ë³´ì´ìŠ¤ í”¼ì‹±", hp: 150, atk: 22, skill: "ê²€ì°° ì‚¬ì¹­", killMsg: "ì„œìš¸ ì¤‘ì•™ ì§€ê²€ì´ë¼ë©´ì„œìš”." },
        { name: "ë¬´í•œ ë¡œë”© ì§€ì˜¥", hp: 160, atk: 20, skill: "ë±…ê¸€ë±…ê¸€ ì €ì£¼", killMsg: "ë¹™ê¸€ë¹™ê¸€ ì§€ì˜¥." },
        { name: "ì•ˆ ì§€ì›Œì§€ëŠ” ì–¼ë£©", hp: 145, atk: 18, skill: "ë§ˆë¼íƒ• ê³µê²©", killMsg: "ìµœì•  ì…”ì¸ ì— ë§ˆë¼íƒ•ì„..." },
        { name: "ì•ˆ ì—´ë¦¬ëŠ” ëšœê»‘", hp: 155, atk: 16, skill: "ì§„ê³µ ë°€ì°©", killMsg: "ê³ ë¬´ì¥ê°‘ ê»´ë„ ì•ˆ ì—´ë ¤ìš”." },
        { name: "ê²¨ìš¸ ì •ì „ê¸°", hp: 170, atk: 25, skill: "ì°Œë¦¿ì°Œë¦¿", killMsg: "ì†ëì´ íƒ€ë“¤ì–´ê°‘ë‹ˆë‹¤." },
        { name: "ë§Œì› ë²„ìŠ¤ ë°±íŒ©", hp: 180, atk: 22, skill: "ì§„ë¡œ ë°©í•´", killMsg: "ê°€ë°©ì— ë°€ë ¤ ëª» ë‚´ë ¸ìŠµë‹ˆë‹¤." }
    ];
    // (ì´í•˜ ê·¸ë£¹ 3,4,5 ë°ì´í„° ê°„ëµí™” ì²˜ë¦¬)
    MONSTER_GROUPS[2] = [{name:"í‡´ê·¼ì§ì „ íŒ€ì¥ë‹˜", hp:400, atk:50, skill:"ì´ê²ƒë§Œ í•˜ê³  ê°€", killMsg:"..."}, {name:"ì½ì”¹ ì¸ë…€", hp:350, atk:55, skill:"ìˆ«ì 1", killMsg:"..."}, {name:"ì¸µê°„ì†ŒìŒ ë§ì¹˜", hp:380, atk:60, skill:"ë“œë¦´ë§", killMsg:"..."}, {name:"ë¹„ì˜¤ëŠ” í°ìš´ë™í™”", hp:400, atk:45, skill:"ì§„í™", killMsg:"..."}, {name:"ë¹„ë²ˆ 5íšŒì˜¤ë¥˜", hp:420, atk:65, skill:"ì ê¸ˆ", killMsg:"..."}, {name:"ê³ ì¥ë‚œ í‚¤ë³´ë“œ", hp:450, atk:60, skill:"ì—”í„°ë¨¹í†µ", killMsg:"..."}, {name:"ì˜†ì§‘ íƒë°°ì˜¤ë°°ì†¡", hp:400, atk:50, skill:"í•˜ë½", killMsg:"..."}, {name:"ì¤‘ê³ ë‚˜ë¼ ë²½ëŒ", hp:500, atk:70, skill:"ë°”ê¿”ì¹˜ê¸°", killMsg:"..."}, {name:"ìœ í†µê¸°í•œ ìš°ìœ ", hp:450, atk:80, skill:"ë³µí†µ", killMsg:"..."}, {name:"ì¡°ë³„ê³¼ì œ ë¹ŒëŸ°", hp:500, atk:60, skill:"ì ìˆ˜", killMsg:"..."}];
    MONSTER_GROUPS[3] = [{name:"ìƒˆë¼ë°œê°€ë½ ì°§ìŒ", hp:1500, atk:200, skill:"ëª¨ì„œë¦¬", killMsg:"..."}, {name:"ì €ì¥ ì•ˆí•œ ë¬¸ì„œ", hp:1600, atk:220, skill:"ì‘ë‹µì—†ìŒ", killMsg:"..."}, {name:"ê¸‰ë˜¥ ì‹ í˜¸", hp:1400, atk:180, skill:"ë’¤í‹€ê¸°", killMsg:"..."}, {name:"ì…ê¸ˆ ì „ í´ë¼ì´ì–¸íŠ¸", hp:1800, atk:250, skill:"ìˆ˜ì •", killMsg:"..."}, {name:"ì•¼ë™ ìŠ¤í”¼ì»¤", hp:2000, atk:350, skill:"ìˆ˜ì¹˜ì‚¬", killMsg:"..."}, {name:"ì˜ëª» ë³´ë‚¸ ì¹´í†¡", hp:1500, atk:220, skill:"ì·¨ì†Œì‹¤íŒ¨", killMsg:"..."}, {name:"ê¹œë¹¡í•œ ì—ì–´ì»¨", hp:1700, atk:180, skill: "ì „ê¸°ì„¸", killMsg:"..."}, {name:"ğŸ‘‘ ì›”ìš”ì¼ 8:59AM", hp:3500, atk:400, skill:"ì•ŒëŒ", killMsg:"..."}, {name:"ğŸ‘‘ ìœˆë„ìš° ì—…ë°ì´íŠ¸", hp:3800, atk:350, skill:"ì¬ë¶€íŒ…", killMsg:"..."}, {name:"ğŸ‘‘ ëª…ì ˆ ì”ì†Œë¦¬", hp:3200, atk:300, skill:"ì·¨ì—…ì½¤ë³´", killMsg:"..."}];
    MONSTER_GROUPS[4] = [{name:"ğŸ‘‘ ì˜ˆë¹„êµ° í†µì§€ì„œ", hp:8000, atk:600, skill:"ì…ì†Œ", killMsg:"..."}, {name:"ğŸ‘‘ ëˆ„ì§„ì„¸ ê³ ì§€ì„œ", hp:9000, atk:700, skill:"í­ê²©", killMsg:"..."}, {name:"ğŸ‘‘ ì•¡ì • íŒŒì†", hp:8500, atk:650, skill:"í¬ë™", killMsg:"..."}, {name:"ğŸ‘‘ ìë‹ˆ? ì „ì• ì¸", hp:7000, atk:800, skill:"ì¶”ì–µíŒ”ì´", killMsg:"..."}, {name:"ğŸ‘‘ ì„œë²„ ì ê²€", hp:8000, atk:500, skill:"ì—°ì¥", killMsg:"..."}, {name:"ğŸ‘‘ ë¶€ì¥ë‹˜ ê°œì¸ê¸°", hp:7500, atk:550, skill:"ì•„ì¬ê°œê·¸", killMsg:"..."}, {name:"ğŸ‘‘ ë¹„ìƒê¸ˆ ê±¸ë¦¼", hp:10000, atk:900, skill:"ì••ìˆ˜", killMsg:"..."}, {name:"ğŸ‘‘ í‡´ì‚¬ ì„œë¥˜ ë°˜ë ¤", hp:15000, atk:1200, skill:"ì¢…ì‹ ", killMsg:"..."}, {name:"ğŸ‘‘ ëŒ€ì¶œ ì´ì ì¸ìƒ", hp:18000, atk:1500, skill:"íŒŒì‚°", killMsg:"..."}, {name:"ğŸ‘‘ ì¸ì‚¬íŒ€ì¥", hp:30000, atk:2000, skill:"ê¶Œê³ ì‚¬ì§", killMsg:"..."}];

    let player = {
        lv: 1, hp: 100, gold: 0, potion: 2, kills: 0, book: {}, currentStage: 0,
        base: { atk: 10, hp: 100, crit: 5, dodge: 5 },
        equip: { weapon: null, hat: null, top: null, bottom: null, glove: null, neck: null, wrist: null }
    };
    let monster = null;
    let bookOpen = false;

    function init() {
        spawn(); updateUI(); initBook();
        setInterval(battle, 1000);
    }

    function initBook() {
        const grid = document.getElementById('book-grid'); grid.innerHTML = "";
        MONSTER_GROUPS.forEach((group, gIdx) => {
            group.forEach(m => {
                const div = document.createElement('div');
                div.className = "book-item"; div.id = `book-${m.name}`;
                div.innerText = `[G${gIdx+1}] ???`; grid.appendChild(div);
            });
        });
    }

    function spawn() {
        const pool = MONSTER_GROUPS[player.currentStage];
        const d = pool[Math.floor(Math.random() * pool.length)];
        const growth = 1 + (player.lv * 0.2);
        monster = { ...d, hp: Math.floor(d.hp * growth), max: Math.floor(d.hp * growth), atk: Math.floor(d.atk * growth) };
        addLog(`[Stage ${player.currentStage+1}] <b>${monster.name}</b> ì¶œí˜„!`);
        updateUI();
    }

    function getStats() {
        let s = { ...player.base };
        for(let t in player.equip) {
            let item = player.equip[t]; if(!item) continue;
            if(t === 'weapon') s.atk += item.val;
            else if(t === 'neck') s.dodge = Math.min(50, s.dodge + (item.val/5));
            else if(t === 'wrist') s.crit = Math.min(75, s.crit + (item.val/5));
            else s.hp += item.val * 5;
        }
        return s;
    }

    function battle() {
        if (player.hp <= 0 || bookOpen) return;
        let s = getStats();
        let critHit = Math.random() * 100 < s.crit;
        monster.hp -= s.atk * (critHit ? 2 : 1);
        if (monster.hp <= 0) { win(); return; }
        if (Math.random() * 100 < s.dodge) {
            addLog(`ğŸ’¨ íšŒí”¼!`);
        } else {
            player.hp -= monster.atk;
            addLog(`ğŸ’¢ -${monster.atk} í”¼í•´`);
            if (player.hp <= 0) die();
        }
        updateUI();
    }

    function win() {
        player.kills++; player.lv++; player.gold += (player.currentStage + 1) * 100;
        player.book[monster.name] = true;
        
        // [MODIFIED] íšŒë³µ ì•„ì´í…œ íšë“ í™•ë¥  1/2 (50%)
        if (Math.random() < 0.5) {
            player.potion++;
            addLog(`<span style="color:var(--gold)">[ì„±ê³µ]</span> ğŸ• í”¼ì íšë“!`);
        } else {
            addLog(`<span style="color:#888">[ì„±ê³µ]</span> ì•„ì´í…œ íšë“ ì‹¤íŒ¨..`);
        }

        const bookEl = document.getElementById(`book-${monster.name}`);
        if(bookEl) { bookEl.innerText = monster.name; bookEl.classList.add('unlocked'); }

        // ìŠ¤í…Œì´ì§€ ì²´í¬
        const currentGroup = MONSTER_GROUPS[player.currentStage];
        if (currentGroup.every(m => player.book[m.name]) && player.currentStage < 4) {
            player.currentStage++;
            addLog(`<span style="color:var(--unique)">ğŸ‰ STAGE ${player.currentStage+1} UNLOCKED!</span>`);
        }
        spawn();
    }

    function usePotion() {
        if (player.potion <= 0) return;
        let s = getStats();
        player.potion--;
        player.hp = Math.min(s.hp, player.hp + Math.floor(s.hp * 0.6));
        addLog("ğŸ• í”¼ì ì„­ì·¨! ë©˜íƒˆ íšŒë³µ.");
        updateUI();
    }

    function die() {
        player.hp = 0;
        document.getElementById('killer-name').innerText = monster.name;
        document.getElementById('game-over').style.display = 'flex';
        updateUI();
    }

    function toggleBook() { bookOpen = !bookOpen; document.getElementById('book-modal').style.display = bookOpen ? 'flex' : 'none'; }

    function addLog(msg) {
        const logWin = document.getElementById('log-window');
        const div = document.createElement('div'); div.className = "log-entry";
        div.innerHTML = msg; logWin.insertBefore(div, logWin.firstChild);
        if (logWin.childNodes.length > 15) logWin.lastChild.remove();
    }

    // [MODIFIED] ìƒì„¸ ìŠ¤í…Œì´ì§€ ì •ë³´ ë°˜ì˜ UI ì—…ë°ì´íŠ¸
    function updateUI() {
        let s = getStats();
        // ìŠ¤í…Œì´í„°ìŠ¤ íŒ¨ë„ ì—…ë°ì´íŠ¸
        document.getElementById('st-lv').innerText = player.lv;
        document.getElementById('st-kills').innerText = player.kills;
        document.getElementById('st-atk').innerText = s.atk;
        document.getElementById('st-crit').innerText = s.crit.toFixed(1) + "%";
        document.getElementById('st-dodge').innerText = s.dodge.toFixed(1) + "%";
        document.getElementById('st-gold').innerText = player.gold;

        // ì²´ë ¥ë°”
        document.getElementById('p-hp-bar').style.width = (player.hp / s.hp * 100) + "%";
        document.getElementById('p-hp-text').innerText = `${Math.max(0, player.hp)} / ${s.hp}`;
        document.getElementById('m-hp-bar').style.width = (monster.hp / monster.max * 100) + "%";
        document.getElementById('m-hp-val').innerText = `${Math.max(0, monster.hp)} / ${monster.max}`;
        document.getElementById('m-name').innerText = monster.name;
        document.getElementById('heal-count').innerText = player.potion;
        document.getElementById('heal-btn').disabled = player.potion <= 0;

        // ë„ê° ì§„í–‰ë„
        const count = Object.keys(player.book).length;
        document.getElementById('book-main-count').innerText = count;
        document.getElementById('book-progress-fill').style.width = (count / 50 * 100) + "%";
        
        const stages = ["ì¼ìƒì˜ ì‹œë ¨", "ì‚¬íšŒì˜ ì“´ë§›", "ì‚¬ë‚´ ì •ì¹˜", "í˜„ì‹¤ì˜ ë²½", "ì‚¬íšŒì  ë©¸ë§"];
        document.getElementById('current-stage-text').innerText = `STAGE ${player.currentStage + 1}: ${stages[player.currentStage]}`;
    }

    window.onload = init;
</script>
</body>
</html>