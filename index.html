<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VILLAIN HUNTER : Complete 30</title>
    <style>
        :root {
            --bg-color: #000000;
            --panel-bg: #111111;
            --text-main: #ffffff;
            --text-sub: #aaaaaa;
            --accent: #ffffff;
            --border: #333333;
            --highlight: #ffff00;
            --danger: #ff4444;
        }

        body { 
            background: var(--bg-color); 
            color: var(--text-main); 
            font-family: 'Pretendard', sans-serif; 
            display: flex; justify-content: center; padding: 20px; margin: 0;
        }

        #game-container { 
            width: 100%; max-width: 420px; 
            background: var(--panel-bg); 
            border-radius: 16px; padding: 25px; 
            border: 1px solid var(--border);
            position: relative;
        }

        .header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 25px; border-bottom: 2px solid var(--border); padding-bottom: 15px;
        }
        h2 { margin: 0; font-weight: 800; font-size: 20px; letter-spacing: 1px; color: #fff; }
        
        .book-trigger { 
            background: #222; color: #fff; border: 1px solid #444; 
            padding: 6px 12px; border-radius: 6px; font-size: 12px; cursor: pointer;
            font-weight: bold;
        }

        .panel { 
            background: rgba(255,255,255,0.05);
            border-radius: 12px; padding: 18px; margin-bottom: 15px; 
        }

        .title { color: var(--highlight); font-size: 11px; font-weight: 800; text-transform: uppercase; margin-bottom: 12px; display: block; letter-spacing: 1px; }

        .hp-bar-bg { width: 100%; height: 8px; background: #222; margin: 10px 0; border-radius: 4px; overflow: hidden; }
        .hp-fill { height: 100%; transition: width 0.3s ease; }
        .p-hp-fill { background: #fff; }
        .m-hp-fill { background: var(--danger); }

        #heal-btn { 
            width: 100%; background: #fff; color: #000; margin-bottom: 15px;
            padding: 14px; font-size: 14px; font-weight: 900;
        }
        #heal-btn:not(:disabled) { 
            border: 2px solid var(--highlight); 
            box-shadow: 0 0 15px rgba(255, 255, 0, 0.3);
        }

        button { 
            background: #fff; color: #000; border: none; 
            padding: 12px; cursor: pointer; font-weight: 800; 
            border-radius: 8px; transition: 0.2s;
        }
        button:disabled { background: #222; color: #555; cursor: not-allowed; }

        #log-window { 
            height: 130px; overflow-y: auto; font-size: 13px; color: #999; 
            padding: 10px; background: rgba(0,0,0,0.3); border-radius: 8px;
            display: flex; flex-direction: column-reverse; gap: 6px;
        }

        #game-over, #book-ui, #ending-ui { 
            display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; 
            z-index: 100; padding: 30px; box-sizing: border-box;
            background: #000; flex-direction: column; align-items: center; justify-content: center; text-align: center;
        }
        
        .m-skill { color: #ff9900; font-weight: bold; }
        .rare-msg { color: #ff3e3e; font-weight: 900; }
        #inv { font-size: 11px; color: #888; margin-top: 10px; font-weight: bold; }
        
        /* ìŠ¤í¬ë¡¤ë°” ì»¤ìŠ¤í…€ */
        #book-list::-webkit-scrollbar { width: 4px; }
        #book-list::-webkit-scrollbar-thumb { background: #333; }
    </style>
</head>
<body>

<div id="game-container">
    <div id="game-over">
        <h1 style="color:red">DEFEATED</h1>
        <p>ì‹ì‚¬ ë©”ë‰´ê°€ ëª¨ë‘ ì‚¬ë¼ì¡ŒìŠµë‹ˆë‹¤.</p>
        <button onclick="revive()">ë¶€í™œí•˜ê¸°</button>
    </div>

    <div id="book-ui">
        <h3 style="color: var(--highlight);">VILLAIN BESTIARY (<span id="book-count">0</span>/30)</h3>
        <div id="book-list" style="width: 100%; height: 300px; overflow-y: auto; margin: 20px 0; font-size: 13px; color: #eee; text-align: left; border: 1px solid #222; padding: 10px;"></div>
        <button onclick="toggleBook()" style="width: 100%;">ì‚¬ëƒ¥í„°ë¡œ ë³µê·€</button>
    </div>

    <div id="ending-ui">
        <h1 style="letter-spacing: 5px; color:gold">NIRVANA</h1>
        <p>30ì¢…ì˜ ë¹ŒëŸ°ì„ ëª¨ë‘ ì •ë³µí–ˆìŠµë‹ˆë‹¤.<br>ë‹¹ì‹ ì€ ì´ì œ ì§„ì •í•œ í•´íƒˆìì…ë‹ˆë‹¤.</p>
        <button onclick="rebirth()" style="margin-top:20px">ë³´ë„ˆìŠ¤ ë°›ê³  í™˜ìƒ</button>
    </div>

    <div class="header">
        <h2>VILLAIN HUNTER</h2>
        <button class="book-trigger" onclick="toggleBook()">ğŸ“• ë„ê° <span id="book-count-header">0</span>/30</button>
    </div>
    
    <div class="panel">
        <span class="title">My Status</span>
        <div style="display: flex; justify-content: space-between; font-size: 16px; font-weight: bold;">
            <span id="atk-display">ATK 10</span>
            <span><span id="p-hp">100</span> / <span id="p-max">100</span></span>
        </div>
        <div class="hp-bar-bg"><div id="p-hp-bar" class="hp-fill p-hp-fill"></div></div>
        
        <button id="heal-btn" onclick="usePotion()">ğŸ• ì ì‹¬ ë©”ë‰´ <span id="heal-count">(0)</span></button>
        
        <div style="display: flex; justify-content: space-between; font-size: 11px; font-weight: bold; color:#777">
            <span>GOLD: <span id="gold">0</span></span>
            <span>LEVEL: <span id="lv-display">1</span></span>
            <span>REBIRTH: <span id="re-count">0</span></span>
        </div>
    </div>

    <div class="panel">
        <span class="title" id="m-name">Targeting...</span>
        <div class="hp-bar-bg"><div id="m-hp-bar" class="hp-fill m-hp-fill"></div></div>
        <div id="m-hp-text" style="text-align: right; font-size: 12px; font-weight: bold; color: #fff;">0 / 0</div>
    </div>

    <div class="panel" style="background: rgba(255,255,255,0.02); border: 1px dashed #444;">
        <span class="title">Workshop</span>
        <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px;">
            <button id="btn1" onclick="craft('íš¨ìì†', 20, 'ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·', 3)">íš¨ìì†</button>
            <button id="btn2" onclick="craft('í¸ì§€', 80, 'ì‚¬ì§ì„œ', 1)">í¸ì§€</button>
            <button id="btn3" onclick="craft('ì†”', 180, 'ì•”ëª¨ë‹ˆì•„', 1)">ì†”</button>
        </div>
        <p id="inv">ì¸ë²¤í† ë¦¬: ë¹„ì–´ìˆìŒ</p>
    </div>

    <div id="log-window"></div>
</div>

<script>
    // ëª¬ìŠ¤í„° 30ì¢… í’€ ë¦¬ìŠ¤íŠ¸ (Normal 25ì¢… + Rare 5ì¢…)
    const MONSTERS = {
        normal: [
            { name: "ì¶œê·¼ ì‹«ì€ ëŒ€ë¦¬ë‹˜", hp: 60, atk: 5, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 20, skill: "ì—…ë¬´ ë©”ì‹ ì € í­ê²©!" },
            { name: "ë²•ì¹´ ì•ˆ ì£¼ëŠ” ë¶€ì¥ë‹˜", hp: 70, atk: 7, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 25, skill: "ì˜ìˆ˜ì¦ ë°˜ë ¤!" },
            { name: "ë¼ë–¼ ì°¨ì¥ë‹˜", hp: 80, atk: 10, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 30, skill: "ë‚˜ë•ŒëŠ” ë§ì´ì•¼!" },
            { name: "ê²°ì •ì¥ì•  ì‚¬ì›", hp: 50, atk: 4, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 15, skill: "ì•„ë¬´ê±°ë‚˜ìš”!" },
            { name: "ë°ì´í„° ì—†ëŠ” í°", hp: 45, atk: 6, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 20, skill: "ë¬´í•œ ë¡œë”©!" },
            { name: "í‡´ê·¼ì§ì „ íŒ€ì¥ë‹˜", hp: 110, atk: 18, drop: "ì‚¬ì§ì„œ", gold: 50, skill: "ì ê¹ ë‚˜ì¢€ ë´?" },
            { name: "ìƒˆë¼ë°œê°€ë½ ì°§ìŒ", hp: 150, atk: 50, drop: "ì•”ëª¨ë‹ˆì•„", gold: 100, skill: "ì¹¨ë¬µì˜ ë¹„ëª…!" },
            { name: "ì¼ìš”ì¼ ë°¤ ìš°ìš¸í•¨", hp: 140, atk: 22, drop: "ì‚¬ì§ì„œ", gold: 60, skill: "ë‚´ì¼ ì¶œê·¼ì´ì•¼.." },
            { name: "ë‹«íˆëŠ” ì§€í•˜ì²  ë¬¸", hp: 130, atk: 25, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 55, skill: "ì§€ê° í™•ì •!" },
            { name: "í’ˆì ˆëœ í•œì •íŒ", hp: 160, atk: 35, drop: "ì‚¬ì§ì„œ", gold: 80, skill: "í’ˆì ˆì˜ ìŠ¬í””!" },
            { name: "ì½ì”¹í•˜ëŠ” ì—°ì• ìƒëŒ€", hp: 90, atk: 15, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 35, skill: "1 ì•ˆì‚¬ë¼ì§!" },
            { name: "ëˆ…ëˆ…í•œ ì¹˜í‚¨ê»ì§ˆ", hp: 55, atk: 5, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 18, skill: "ê¸°ë¦„ê¸° ê³µê²©!" },
            { name: "ìŠ¤í¬ì¼ëŸ¬ ë¹ŒëŸ°", hp: 100, atk: 20, drop: "ì‚¬ì§ì„œ", gold: 45, skill: "ì£¼ì¸ê³µ ì£½ìŒ!" },
            { name: "ë§Œì› ë²„ìŠ¤ ë°±íŒ©", hp: 120, atk: 12, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 40, skill: "ë°€ì¹˜ê¸° ê³µê²©!" },
            { name: "ì•ˆí„°ì§€ëŠ” ê³µìš© ì™€ì´íŒŒì´", hp: 70, atk: 8, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 22, skill: "ë¡œë”© ì§€ì˜¥!" },
            { name: "í‹€ë¦° ë¹„ë²ˆ 5íšŒ", hp: 135, atk: 25, drop: "ì‚¬ì§ì„œ", gold: 65, skill: "ë³¸ì¸ì¸ì¦ ë£¨í”„!" },
            { name: "ì¶©ì „ê¸° ê³ ì¥", hp: 85, atk: 14, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 32, skill: "ë°°í„°ë¦¬ 1%!" },
            { name: "ì¸µê°„ì†ŒìŒ ë§ì¹˜ì§ˆ", hp: 155, atk: 28, drop: "ì•”ëª¨ë‹ˆì•„", gold: 75, skill: "ì²œì¥ ìš¸ë¦¼!" },
            { name: "ë¹„ ì˜¤ëŠ” ë‚  í° ìš´ë™í™”", hp: 115, atk: 18, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 48, skill: "ì§„í™ íŠ€ê¸°ê¸°!" },
            { name: "ì´ì–´í° í•œìª½ ì•ˆë“¤ë¦¼", hp: 95, atk: 12, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 38, skill: "ë¶ˆê· í˜•ì˜ ê³ í†µ!" },
            { name: "ìœ íŠœë¸Œ í”„ë¦¬ë¯¸ì—„ ëë‚¨", hp: 105, atk: 15, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 42, skill: "5ì´ˆ ê´‘ê³ !" },
            { name: "ê²¨ìš¸ì²  ì •ì „ê¸°", hp: 65, atk: 30, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 28, skill: "ì°Œë¦¿ ê³µê²©!" },
            { name: "íƒë°° ì˜¤ë°°ì†¡", hp: 145, atk: 20, drop: "ì‚¬ì§ì„œ", gold: 70, skill: "ë°˜í’ˆ ì§€ì˜¥!" },
            { name: "ì¹´í˜ ì¹´ê³µì¡± ë…¸ë ¤ë³´ê¸°", hp: 125, atk: 16, drop: "ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·", gold: 50, skill: "í‚¤ë³´ë“œ ì†ŒìŒ ì£¼ì˜!" },
            { name: "í™”ì¥ì‹¤ íœ´ì§€ ì—†ìŒ", hp: 170, atk: 40, drop: "ì•”ëª¨ë‹ˆì•„", gold: 90, skill: "ì ˆì²´ì ˆëª…ì˜ ìœ„ê¸°!" }
        ],
        rare: [
            { name: "ğŸ‘‘ ì›”ìš”ì¼ 8:59 AM", hp: 900, atk: 65, gold: 500, drop: "ì‚¬ì§ì„œ", skill: "ì•ŒëŒ 10ì—°íƒ€!" },
            { name: "ğŸ‘‘ 3ë…„ ì•ˆ ë¹¤ ì–‘ë§", hp: 700, atk: 75, gold: 450, drop: "ì•”ëª¨ë‹ˆì•„", skill: "í™”í•™ í…ŒëŸ¬!" },
            { name: "ğŸ‘‘ ìœˆë„ìš° ê°•ì œ ì—…ë°ì´íŠ¸", hp: 1100, atk: 60, gold: 600, drop: "ì‚¬ì§ì„œ", skill: "ì‘ì—… ë‚ ë¦¬ê¸°!" },
            { name: "ğŸ‘‘ ëª…ì ˆ ì”ì†Œë¦¬ ì½¤ë³´", hp: 1300, atk: 50, gold: 700, drop: "ì‚¬ì§ì„œ", skill: "ì·¨ì—…/ê²°í˜¼ ê³µê²©!" },
            { name: "ğŸ‘‘ ìë‹ˆ? ì „ì• ì¸ ë¬¸ì", hp: 1000, atk: 85, gold: 550, drop: "ì•”ëª¨ë‹ˆì•„", skill: "ìƒˆë²½ ê°ì„± í­ê²©!" }
        ]
    };

    let player = { lv:1, atk:10, hp:100, maxHp:100, gold:0, inv:{}, book:{}, rebirthCount:0, potion:1, isDead: false, totalKills: 0 };
    let monster = { name:"", hp:0, max:0, atk:0, drop:"", gold:0, skill:"" };

    function battle() {
        if (player.isDead) return;
        monster.hp -= player.atk;
        if (monster.hp > 0) {
            player.hp -= monster.atk;
            if (Math.random() < 0.2) addLog(`<span class="m-skill">[${monster.name}] ${monster.skill}</span>`);
        }
        if (player.hp <= 0) { player.hp = 0; gameOver(); } 
        else if (monster.hp <= 0) { win(); }
        updateUI();
    }

    function usePotion() {
        if (player.potion > 0 && !player.isDead) {
            player.potion--;
            player.hp = Math.min(player.maxHp, player.hp + Math.floor(player.maxHp * 0.8));
            addLog(`ğŸ• <span style="color:#00ff00">í­í’ í¡ì…! ì²´ë ¥ì„ 80% íšŒë³µí–ˆìŠµë‹ˆë‹¤.</span>`);
            updateUI();
        }
    }

    function win() {
        player.gold += monster.gold;
        player.totalKills++;
        player.book[monster.name] = (player.book[monster.name] || 0) + 1;
        player.hp = Math.min(player.maxHp, player.hp + Math.floor(player.maxHp * 0.2)); 
        
        if (Math.random() < 0.3) player.potion++;
        if (Math.random() > 0.4) player.inv[monster.drop] = (player.inv[monster.drop] || 0) + 1;
        
        // ë„ê° ì²´í¬ (ì‹¤ì œ 30ì¢… í™•ì¸)
        const collected = Object.keys(player.book).length;
        if (collected >= 30) {
            document.getElementById('ending-ui').style.display = 'flex';
            player.isDead = true;
            return;
        }
        
        player.lv++; spawn(); save();
    }

    function spawn() {
        // ì´ˆë°˜ ë‚œì´ë„ ì¡°ì ˆ: 10í‚¬ ì „ì—ëŠ” ì•½í•œ ëª¹ë§Œ
        let pool = (player.totalKills < 10) ? MONSTERS.normal.slice(0, 10) : MONSTERS.normal;
        
        // ë ˆì–´ í™•ë¥  (ì§„í–‰ë„ ë¹„ë¡€)
        const rareChance = Math.min(0.1 + (player.totalKills * 0.005), 0.25);
        const isRare = (Math.random() < rareChance && player.totalKills > 15);
        
        let d = isRare ? MONSTERS.rare[Math.floor(Math.random()*MONSTERS.rare.length)] 
                       : pool[Math.floor(Math.random()*pool.length)];

        monster = { ...d, max: d.hp+(player.lv*6), hp: d.hp+(player.lv*6), atk: d.atk+(player.lv) };
        if(isRare) addLog(`<span class="rare-msg">âš  WARNING: ${monster.name} âš </span>`);
        updateUI();
    }

    function rebirth() {
        const rc = (player.rebirthCount || 0) + 1;
        player = { lv:1, atk:10+(rc*120), hp:150, maxHp:150, gold:0, inv:{}, book:{}, rebirthCount:rc, potion:1, isDead:false, totalKills:0 };
        document.getElementById('ending-ui').style.display='none';
        spawn(); save(); updateUI();
    }

    function toggleBook() {
        const ui = document.getElementById('book-ui');
        ui.style.display = (ui.style.display === 'flex') ? 'none' : 'flex';
        if(ui.style.display === 'flex') renderBook();
    }

    function renderBook() {
        const list = document.getElementById('book-list');
        list.innerHTML = "";
        const allMonsters = [...MONSTERS.normal, ...MONSTERS.rare];
        allMonsters.forEach(m => {
            const s = player.book[m.name] || 0;
            list.innerHTML += `<div style="padding:6px 0; border-bottom:1px solid #222; display:flex; justify-content:space-between; color:${s>0?'#fff':'#444'}">
                <span>${s>0 ? m.name : '??? (ë¯¸ë°œê²¬)'}</span>
                <span>${s}íšŒ ë°•ì‚´</span>
            </div>`;
        });
        document.getElementById('book-count').innerText = Object.keys(player.book).length;
    }

    function save() { localStorage.setItem('funny_hunter_v30', JSON.stringify(player)); }
    function load() {
        const s = localStorage.getItem('funny_hunter_v30');
        if(s) { player = JSON.parse(s); player.isDead = false; if(player.hp <= 0) player.hp = player.maxHp; }
        spawn();
    }

    function gameOver() { 
        player.isDead = true; 
        player.potion = 0; 
        document.getElementById('game-over').style.display = 'flex'; 
        save();
    }

    function revive() { 
        player.isDead = false; player.hp = player.maxHp; player.gold = Math.floor(player.gold*0.8); 
        document.getElementById('game-over').style.display = 'none'; spawn(); updateUI(); 
    }
    
    function craft(n, p, m, c) {
        if((player.inv[m]||0)>=c) { 
            player.inv[m]-=c; player.atk+=p; player.maxHp+=50; player.hp=player.maxHp; 
            addLog(`ğŸ›  ${n} ì œì‘! ê³µê²©ë ¥+${p}, ìµœëŒ€ì²´ë ¥+50`); updateUI(); save(); 
        }
    }

    function updateUI() {
        document.getElementById('p-hp').innerText = Math.floor(player.hp);
        document.getElementById('p-max').innerText = player.maxHp;
        document.getElementById('p-hp-bar').style.width = (player.hp/player.maxHp*100) + "%";
        document.getElementById('m-hp-bar').style.width = (monster.hp/monster.max*100) + "%";
        document.getElementById('m-hp-text').innerText = `${Math.max(0, Math.floor(monster.hp))} / ${monster.max}`;
        document.getElementById('atk-display').innerText = `ATK ${player.atk}`;
        document.getElementById('gold').innerText = Math.floor(player.gold);
        document.getElementById('re-count').innerText = player.rebirthCount || 0;
        document.getElementById('lv-display').innerText = player.lv;
        document.getElementById('m-name').innerText = `Target: ${monster.name}`;
        document.getElementById('heal-count').innerText = `(${player.potion})`;
        
        const count = Object.keys(player.book).length;
        document.getElementById('book-count-header').innerText = count;
        
        const hBtn = document.getElementById('heal-btn');
        hBtn.disabled = (player.potion <= 0 || player.isDead);
        
        let invS = "ì¸ë²¤í† ë¦¬: ";
        let hasItem = false;
        for(let k in player.inv) if(player.inv[k]>0) { invS += `${k}(${player.inv[k]}) `; hasItem = true; }
        document.getElementById('inv').innerText = hasItem ? invS : "ì¸ë²¤í† ë¦¬: ë¹„ì–´ìˆìŒ";
        
        document.getElementById('btn1').disabled = (player.inv['ëˆ…ëˆ…í•œ íŠ€ê¹€ì˜·'] || 0) < 3;
        document.getElementById('btn2').disabled = (player.inv['ì‚¬ì§ì„œ'] || 0) < 1;
        document.getElementById('btn3').disabled = (player.inv['ì•”ëª¨ë‹ˆì•„'] || 0) < 1;
    }

    function addLog(m) {
        const l = document.getElementById('log-window');
        l.innerHTML = `<div>> ${m}</div>` + l.innerHTML;
        if (l.childNodes.length > 25) l.removeChild(l.lastChild);
    }

    window.onload = () => { load(); updateUI(); setInterval(battle, 1000); };
</script>
</body>
</html>